"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const utils_1 = require("../utils");
const DEFAULT_THRESHOLD = 1024;
/* eslint-disable no-redeclare */
function ArrayExpression(path, state) {
    try {
        const obj = utils_1.converter(path.node);
        const json = JSON.stringify(obj);
        // escaping for single quotes
        const escapedJson = json.replace(/'/g, "\\'");
        // it simply isn't worth it to convert into the AST objects that are too small.
        // so, this plugin only convert large objects by default.
        const { minJSONStringSize } = state.opts;
        const threshold = (minJSONStringSize !== null && minJSONStringSize !== void 0 ? minJSONStringSize : DEFAULT_THRESHOLD);
        if (escapedJson.length < threshold) {
            return;
        }
        path.replaceWithSourceString(`JSON.parse('${escapedJson}')`);
    }
    catch (e) {
        // disable error message
        // const { loc } = path.parent
        // const line = loc && loc.start.line
        // console.error(
        //   `At ${line} line (start) : The object wasn't converted (${e.message})`
        // )
    }
}
exports.ArrayExpression = ArrayExpression;
