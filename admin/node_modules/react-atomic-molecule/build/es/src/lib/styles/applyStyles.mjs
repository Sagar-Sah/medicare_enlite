import { IS_ARRAY, KEYS } from "reshow-constant";

var applyClassName = function applyClassName(props, order, oStyle) {
  var styleId = oStyle.styleId;
  var arr = [styleId];

  for (var j = 1; j <= order; j++) {
    arr.push(styleId + j);
  }

  props.className = (props.className ? props.className + " " : "") + arr.join(" ");
  return props;
};

var applyInlineStyle = function applyInlineStyle(props, order, oStyle) {
  if (IS_ARRAY(oStyle.selector)) {
    return props;
  }

  if (!props.style) {
    props.style = {};
  }

  oStyle.style.forEach(function (one) {
    return KEYS(one).forEach(function (key) {
      return props.style[key] = one[key];
    });
  });
  return props;
};

var applyStyle = function applyStyle(props, order) {
  return function (oStyle) {
    if (!oStyle) {
      return props;
    }

    if (!oStyle.isCompiled) {
      console.warn("Not a style object", oStyle);
      return props;
    }

    return oStyle.isCompiled() && order < 10 ? applyClassName(props, order, oStyle) : applyInlineStyle(props, order, oStyle);
  };
};

var applyStyles = function applyStyles(props, styles, order) {
  if (isNaN(order)) {
    order = 0;
  }

  if (!IS_ARRAY(styles)) {
    styles = [styles];
  }

  var apply = applyStyle(props, order);
  return styles.map(function (one) {
    return apply(one);
  });
};

export default applyStyles;