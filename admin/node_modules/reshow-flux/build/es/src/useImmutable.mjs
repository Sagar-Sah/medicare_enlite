import { useRef } from "react";
import useStore from "./useStore.mjs";
import ImmutableStore from "./ImmutableStore.mjs";
/**
 * useState alternative but implement by Immutable.
 * https://reactjs.org/docs/hooks-reference.html#usestate
 *
 *
 * ## Base usage
 * const [state, setState] = useImmutable(initialState);
 *
 * call setState will trigger re-render.
 * could use setState for partial update.
 */

var useImmutable = function useImmutable(initialState) {
  var lastReduce = useRef();

  if (!lastReduce.current) {
    lastReduce.current = ImmutableStore(null, initialState);
  }

  return [useStore(lastReduce.current[0]), lastReduce.current[1]];
};

export default useImmutable;