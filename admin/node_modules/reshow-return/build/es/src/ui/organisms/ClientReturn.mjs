import _objectWithoutProperties from "reshow-runtime/es/helpers/objectWithoutProperties";
var _excluded = ["children", "backfillProps"];
import build from "reshow-build";
import { useLoaded } from "reshow-hooks";
import { hasWin, win } from "win-doc";
import { connectOptions } from "reshow-return";

var hydrate = function hydrate() {
  var _win$Reshow;

  return (_win$Reshow = win().Reshow) === null || _win$Reshow === void 0 ? void 0 : _win$Reshow.hydrate;
};
/**
 * Example: https://github.com/react-atomic/reshow/blob/main/packages/reshow-url/ui/organisms/UrlReturn.jsx
 */


var ClientReturnHoc = function ClientReturnHoc(comp, cleanProps) {
  var ClientReturn = function ClientReturn(props) {
    if (!hasWin() || hydrate()) {
      var isLoad = useLoaded();

      if (!isLoad) {
        var {
          children,
          backfillProps
        } = props,
            restProps = _objectWithoutProperties(props, _excluded);

        return build(children)(connectOptions.reset(restProps, cleanProps));
      }
    }

    return build(comp)(props);
  };

  return ClientReturn;
};

export default ClientReturnHoc;