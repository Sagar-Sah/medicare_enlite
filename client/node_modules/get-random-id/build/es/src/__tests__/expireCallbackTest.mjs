import { expect } from "chai";
import { getSinon as sinon, cleanIt } from "reshow-unit";
import { getTimestamp, expireCallback } from "../index.mjs";
describe("Test expireCallback", function () {
  beforeEach(function () {
    sinon({
      useFakeTimers: true
    });
  });
  afterEach(function () {
    cleanIt();
  });
  it("test run", function () {
    var acture = expireCallback(0, 1, function () {
      return "foo";
    }, function () {
      return "bar";
    });
    expect(acture).to.equal("foo");
  });
  it("test with expire", function () {
    var acture = expireCallback(0, -1, function () {
      return "foo";
    }, function () {
      return "bar";
    });
    expect(acture).to.equal("bar");
  });
  it("test create time not valid", function () {
    var acture = expireCallback(null, 0, function () {
      return "foo";
    }, function () {
      return "bar";
    });
    expect(acture).to.equal("bar");
  });
  it("test expire time not valid", function () {
    var acture = expireCallback(0, null, function () {
      return "foo";
    }, function () {
      return "bar";
    });
    expect(acture).to.equal("foo");
  });
});