"use strict";

var _interopRequireDefault = require("reshow-runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports["default"] = void 0;

var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("reshow-runtime/helpers/objectWithoutPropertiesLoose"));

var _reshowBuild = _interopRequireDefault(require("reshow-build"));

var _reshowHooks = require("reshow-hooks");

var _winDoc = require("win-doc");

var _reshowReturn = require("reshow-return");

var _excluded = ["children", "backfillProps"];

var hydrate = function hydrate() {
  var _win$Reshow;

  return (_win$Reshow = (0, _winDoc.win)().Reshow) === null || _win$Reshow === void 0 ? void 0 : _win$Reshow.hydrate;
};
/**
 * Example: https://github.com/react-atomic/reshow/blob/main/packages/reshow-url/ui/organisms/UrlReturn.jsx
 */


var ClientReturnHoc = function ClientReturnHoc(comp, cleanProps) {
  var ClientReturn = function ClientReturn(props) {
    if (!(0, _winDoc.hasWin)() || hydrate()) {
      var isLoad = (0, _reshowHooks.useLoaded)();

      if (!isLoad) {
        var children = props.children,
            backfillProps = props.backfillProps,
            restProps = (0, _objectWithoutPropertiesLoose2["default"])(props, _excluded);
        return (0, _reshowBuild["default"])(children)(_reshowReturn.connectOptions.reset(restProps, cleanProps));
      }
    }

    return (0, _reshowBuild["default"])(comp)(props);
  };

  return ClientReturn;
};

var _default = ClientReturnHoc;
exports["default"] = _default;
module.exports = exports.default;