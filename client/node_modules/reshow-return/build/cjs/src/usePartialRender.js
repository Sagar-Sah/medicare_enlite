"use strict";

var _interopRequireDefault = require("reshow-runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports["default"] = void 0;

var _react = require("react");

var _reshowFlux = require("reshow-flux");

var _reshowBuild = _interopRequireDefault(require("reshow-build"));

var _callFunc = _interopRequireDefault(require("call-func"));

var _Return = _interopRequireDefault(require("./ui/organisms/Return.js"));

var usePartialRender = function usePartialRender(initRenderKeys, initChildren) {
  var _useReduceStore = (0, _reshowFlux.useReduceStore)(null, function () {
    return (0, _reshowFlux.Map)((0, _callFunc["default"])(initChildren));
  }),
      renderStore = _useReduceStore[0],
      setPartialRender = _useReduceStore[1];

  var _useState = (0, _react.useState)(function () {
    return (0, _callFunc["default"])(initRenderKeys);
  }),
      renderKeys = _useState[0],
      setRenderKeys = _useState[1];

  var renderItems = (0, _react.useMemo)(function () {
    var buildReturn = (0, _reshowBuild["default"])((0, _reshowBuild["default"])(_Return["default"])({
      store: renderStore
    }));
    /**
     * renderKeys could use array like data structure.
     * such as immutable.js
     */

    return (renderKeys && renderKeys.map ? renderKeys : []).map(function (name) {
      return buildReturn({
        key: name,
        name: name,
        initStates: [name]
      }, function (props) {
        return props[props.name] || null;
      });
    });
  }, [renderKeys]);
  return [renderItems, setPartialRender, setRenderKeys];
};

var _default = usePartialRender;
exports["default"] = _default;
module.exports = exports.default;